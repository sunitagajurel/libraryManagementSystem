<!DOCTYPE html>
<html>
<head>
  <title>Universal Library</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    /* CSS styles for the library website */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #333;
      color: #fff;
      padding: 20px;
      text-align: center;
    }

    nav {
      background-color: #f2f2f2;
      padding: 10px;
    }

    nav ul {
      list-style-type: none;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    nav ul li {
      display: inline-block;
      margin: 0 10px;
    }

    nav ul li a {
      color: #333;
      text-decoration: none;
      padding: 5px;
    }

    main {
      padding: 20px;
      text-align: center;
    }

    .search-box {
      margin-bottom: 20px;
    }

    .search-box input[type="text"] {
      width: 300px;
      padding: 5px;
      font-size: 16px;
    }

    .search-box input[type="submit"] {
      padding: 5px 10px;
      font-size: 16px;
      background-color: #333;
      color: #fff;
      border: none;
      cursor: pointer;
    }

    /* styles for popup  */



/* The popup form - hidden by default */
.form-popup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  border: 3px solid #f1f1f1;
  z-index: 9;
  
}

/* Add styles to the form container */
.form-container {
  max-width: 500px;
  padding: 10px;
  background-color: white;
}

/* Full-width input fields */
.form-container input[type=text], .form-container input[type=text] {
  width: 95%;
  padding: 15px;
  margin: 5px 0 22px 0;
  border: none;
  background: #f1f1f1;
}

/* When the inputs get focus, do something */
.form-container input[type=text]:focus, .form-container input[type=text]:focus {
  background-color: #ddd;
  outline: none;
}

/* Set a style for the submit/login button */
.form-container .btn {
  background-color: #04AA6D;
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  width: 100%;
  margin-bottom:10px;
  opacity: 0.8;
}
.blurred {
  filter: blur(5px);
}


    footer {
      background-color: #333;
      color: #fff;
      padding: 20px;
      text-align: center;
    }
  </style>
</head>
<body>
  <header>
    <h1>Welcome to the Universal Library</h1>
  </header>

  <nav>
    <ul>
      <li><a href="#">Home</a></li>
      <li><a href="#">Books</a></li>
      <li><a href="#">Magazines</a></li>
      <li><a href="#">Events</a></li>
      <li onclick="openForm()">ReturnBook</li>
    </ul>
  </nav>

  </style>
</head>
<body>
  <header>
    <h1>Library Book Search</h1>
  </header>

  <main>
    <div class="search-box">
      <input type="text" name="bookname" placeholder="Book Name" id="bookname">
      <input type="text" name="author" placeholder="Author" id="author">
      <select name="genre" id="genre">
        <option value="">genre</option>
        <!-- <option value="fantasy">Fantasy</option> -->
        <option value="Fiction">Fiction </option>
        <option value="Adventure">Adventure</option>
        <option value="Classic">Classic</option>
        <option value="Fantasy">Fantasy</option>
        <option value="Fantasy">Dystopian</option>
        

      </select>
      <input type="submit" value="Search" id="searchBtn">
    </div>
    <div class="result-box" id="resultContainer">
    </div>
  </main>

  <div class = "form-popup" id = "return-form"> 
    <form  action = "/return"  method ="post" class = "form-container"> 
      <h1> return Book </h1>
      <label for = "tid">
        <input type = "text" placeholder = "Enter transaction" name="tid" - required> 
      </label>
      <label for = "bid">
        <input type = "text" placeholder = "Enter Bookid" name = "bid" required> 
      </label>
      <button type = "submit" class = "btn " id = "ret-btn" > Return</button>
      <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
  </form>

    </form>
  </div>

  <script>
    // Handle search button click event
    function openForm() {
    document.getElementById("return-form").style.display = "block";
    
   }

    function closeForm() {

      document.getElementById("return-form").style.display = "none";
    }
    
    $(document).ready(() => {
      $('#searchBtn').click(() => {
        console.log('Button clicked');
        const bookName = $('#bookname').val();
        const author = $('#author').val();
        const genre = $('#genre').val();
        searchBooks(bookName, author, genre);
      });

    
  $('#resultContainer').on('click', '.brw', function() {
    console.log('Borrow button clicked');
    const bookId = $(this).closest('div.book').data('book-id');
    Authorise(parseInt(bookId));
  });

  


      function searchBooks(bookName, author, genre) {
        console.log('Search book with name:' + bookName + author + genre);
        $('#resultContainer').empty();
        $.ajax({
          url: `/search`,
          method: 'GET',
          data: { 
            "bookName": bookName, 
            "author": author, 
            "genre": genre
          },
          success: function(response) {
            var books = response;
            var bookHtml = '<h2>Book Details:</h2>';
            for (let i = 0; i < books.length; i++) {
                bookHtml += '<div class="book" data-book-id="' + books[i].bookid + '">';
                bookHtml += '<h3>Title: ' + books[i].bookName + '</h3>';
                bookHtml += '<p>Author: ' + books[i].author + '</p>';
                bookHtml += '<p>Genre: ' + books[i].genre + '</p>';
                bookHtml += '<p>Rating: ' + books[i].rating + '</p>';
                bookHtml += `<button  class="brw">Borrow</button><button>Return</button>  </div> `;
            }
            $('#resultContainer').html(bookHtml);
          },
          error: function(xhr, status, error) {
            console.error('Error:', error);
          }
        });


        $('#brr').click(() => {
        console.log('Button clicked');
        const bookName = $('#bookname').val();
        const author = $('#author').val();
        const genre = $('#genre').val();
        searchBooks(bookName, author, genre);
      });

      }

      function Authorise(bookId){
        console.log(bookId)
           //check for stid 
           const uid = 2 

           $.ajax({
          url: `/burrow`,
          method: 'GET',
          data: { 
            "uId": uid, 
            "bookId":bookId
          },
          success: function(response) {
            alert(response)
          }
        
      })
      }
    })
    
  </script>


    <h2>Featured Books</h2>

<style>
    .two-column {
      columns: 2;
    }
  </style>
</head>
<body>
  <div>
    <h3>The Lord of the Rings</h3>
    <p>Author: J.R.R. Tolkien</p>
    <p>Description: The Lord of the Rings" is a classic fantasy novel that takes readers on an epic journey through the enchanting world of Middle-earth. With meticulous world-building and a captivating narrative, J.R.R. Tolkien weaves a tale of adventure, heroism, and the timeless struggle between good and evil.</p>
<img src="33.jpg" width="300" height="450">
    <button>Borrow</button>
    <button>Return</button>
  </div>
  <div>
    <h3>Moby-Dick</h3>
    <p>Author: Herman Melville</p>
    <p>Description: "Moby-Dick" is a literary masterpiece that explores the depths of obsession, fate, and the relentless pursuit of an elusive white whale. Herman Melville's novel takes readers on a captivating journey aboard the whaling ship Pequod, led by the enigmatic Captain Ahab.</p>
    <button>Borrow</button>
    <button>Return</button>
  </div>
<img src="44.jpg" width="300" height="450">
</body>



  

  </main>

  <footer>
    <p>&copy; 2023 Universal Library. All rights reserved.</p>
  </footer>
</body>
</html>


<!DOCTYPE html>
<html>
<head>
  <title>Library Search</title>
  <style>
    /* CSS styles for the search webpage */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #333;
      color: #fff;
      padding: 20px;
      text-align: center;
    }

    main {
      padding: 20px;
      text-align: center;
    }

    .search-box {
      margin-bottom: 20px;
    }

    .search-box input[type="text"] {
      width: 300px;
      padding: 5px;
      font-size: 16px;
    }

    .search-box select {
      padding: 5px;
      font-size: 16px;
    }

    .search-box input[type="submit"] {
      padding: 5px 10px;
      font-size: 16px;
      background-color: #333;
      color: #fff;
      border: none;
      cursor: pointer;
    }

</body>
</html>
